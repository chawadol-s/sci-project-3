<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>เอกสารประกอบการเรียน (สไลด์): วิทยาศาสตร์เพิ่มเติม ม.3 - คาบที่ 2</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;700&display=swap">
    <style>
        body {
            font-family: 'Sarabun', sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: #f0f4f8; /* Subtle light blue background for the body */
            overflow: hidden; /* Hide scrollbars */
            color: #333;
        }

        .slideshow-container {
            position: relative;
            width: 100%;
            height: 100vh; /* Full viewport height */
            overflow: hidden;
            background-color: #ffffff; /* Default slide background */
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .slide {
            display: none; /* Hide all slides by default */
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            padding: 40px 80px; /* Adjust padding */
            box-sizing: border-box;
            background-color: #ffffff;
            color: #333;
            flex-direction: column; /* Arrange content vertically */
            justify-content: flex-start; /* Align content to top */
            align-items: center;
            text-align: center;
            transition: opacity 0.5s ease-in-out; /* Smooth transition */
            opacity: 0; /* Start hidden for transition */
             overflow-y: auto; /* Add scroll for long content within a slide */
             padding-bottom: 80px; /* Ensure space above navigation buttons */
        }

        .slide.active {
            display: flex; /* Show the active slide */
            opacity: 1; /* Fade in */
        }

        .slide h1 {
             color: #003366; /* Darker blue for main course title */
             margin-bottom: 10px;
             font-size: 2.2em;
             font-weight: 700;
             text-align: center;
        }

        .slide h2 {
            color: #0056b3; /* Dark blue for main headings */
            margin-top: 0;
            margin-bottom: 20px;
            font-size: 1.8em; /* Larger font for main titles */
            font-weight: 700;
            border-bottom: 3px solid #007bff; /* Underline effect */
            padding-bottom: 10px;
            width: 100%;
            max-width: 900px;
            text-align: center;
        }

         .slide h3 {
            color: #007bff; /* Blue for subheadings */
            margin-top: 20px;
            margin-bottom: 10px;
            font-size: 1.5em;
            font-weight: 700;
            text-align: center; /* Center subheadings */
        }

        .slide p {
            font-size: 1.1em;
            line-height: 1.6;
            margin-bottom: 15px;
             text-align: left; /* Left align paragraphs for readability */
             width: 100%; /* Ensure paragraph takes full width */
             max-width: 900px; /* Max width for paragraph content */
        }

         .slide ul {
             font-size: 1.1em;
             line-height: 1.6;
             margin-bottom: 15px;
             text-align: left; /* Left align list items */
             width: 100%; /* Ensure list takes full width */
             max-width: 900px; /* Max width for list content */
             padding-left: 30px; /* Indent list items */
         }

         .slide li {
             margin-bottom: 8px;
             position: relative; /* For custom bullet points */
         }

         /* Custom bullet points */
         .slide ul li::before {
             content: '•'; /* Use a dot or other character */
             color: #dc3545; /* Red color for problem-related bullet points */
             font-weight: bold;
             display: inline-block;
             width: 1em;
             margin-left: -1em;
         }

        .slide strong {
            color: #0056b3; /* Highlight strong text */
        }

        .slide a {
            color: #007bff;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }


        .slide .content {
            width: 100%;
            max-width: 1100px; /* Slightly wider content area */
            display: flex;
            flex-direction: column;
            align-items: center;
             text-align: center;
             flex-grow: 1; /* Allow content to grow */
             /* overflow-y: auto; This is now on the slide itself */
             /* padding-bottom: 60px; This is now on the slide itself */
        }

         .slide .two-column {
             display: flex;
             width: 100%;
             max-width: 900px;
             gap: 40px; /* Space between columns */
             margin-top: 20px;
             flex-wrap: wrap; /* Allow wrapping on smaller screens */
             justify-content: center; /* Center columns if they wrap */
         }

         .slide .two-column > div {
             flex: 1; /* Distribute space equally */
             min-width: 300px; /* Minimum width before wrapping */
             text-align: left; /* Left align text within columns */
         }

        .slide .activity-box {
            border: 2px dashed #dc3545; /* Red dashed border for activity */
            padding: 25px;
            margin-top: 30px;
            background-color: #fff0f3; /* Very light pinkish */
            border-radius: 10px;
            text-align: left;
            width: 100%;
             max-width: 800px;
             box-shadow: 3px 3px 8px rgba(0,0,0,0.1); /* Subtle shadow */
        }

         .slide .activity-box h4 {
             color: #c82333; /* Dark red */
             margin-top: 0;
             margin-bottom: 15px;
             font-size: 1.3em;
             border-bottom: 2px solid #dc3545;
             padding-bottom: 5px;
         }

         .activity-box label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #0056b3;
        }

        .activity-box input[type="text"],
        .activity-box textarea {
            width: calc(100% - 22px); /* Adjust for padding and border */
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-family: 'Sarabun', sans-serif;
            font-size: 1em;
        }

         .activity-box textarea {
             min-height: 100px; /* Give some space for typing */
             resize: vertical; /* Allow vertical resizing */
         }


        .activity-box button {
            display: block;
            width: 100%;
            padding: 12px;
            background-color: #28a745; /* Green button */
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 1.2em;
            font-family: 'Sarabun', sans-serif;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .activity-box button:hover {
            background-color: #218838; /* Darker green on hover */
        }

         .activity-box button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
         }

         .submission-status {
             margin-top: 20px;
             text-align: center;
             font-weight: bold;
         }

         .status-success {
             color: #28a745; /* Green for success */
         }

         .status-error {
             color: #dc3545; /* Red for error */
         }


        /* Navigation Buttons */
        .navigation-buttons {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
        }

        .navigation-buttons button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 25px; /* Larger padding */
            margin: 0 10px; /* More space between buttons */
            cursor: pointer;
            border-radius: 25px; /* Pill shape */
            font-size: 1.1em;
            transition: background-color 0.3s ease, transform 0.1s ease;
            min-width: 120px; /* Ensure buttons are wide enough */
            box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
        }

        .navigation-buttons button:hover {
            background-color: #0056b3;
            transform: translateY(-2px); /* Slight lift effect */
        }
         .navigation-buttons button:active {
             transform: translateY(0); /* Press effect */
         }

        .navigation-buttons button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
        }

        /* Page Number */
        .page-number {
            position: absolute;
            bottom: 25px;
            right: 30px;
            font-size: 1em;
            color: #555;
            z-index: 10;
        }

        /* Image/Graphic Area Styling */
        .graphic-area {
            margin: 20px auto; /* Center graphic and add margin */
            text-align: center;
            max-height: 250px; /* Limit height for graphics */
            display: flex;
            justify-content: center;
            align-items: center;
            flex-shrink: 0; /* Prevent shrinking */
        }

        .graphic-area svg {
            max-width: 100%;
            max-height: 100%;
            height: auto;
            width: auto;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: block;
        }

         .small-text {
            font-size: 0.95em;
            color: #555;
            margin-top: 5px;
            text-align: center;
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .slide {
                padding: 20px;
            }
            h1 { font-size: 1.8em; }
            h2 { font-size: 1.5em; }
            h3 { font-size: 1.3em; }
            p, ul, li, .activity-box p, .activity-box ul { font-size: 1em; }
            .graphic-area svg { max-width: 100%; max-height: 180px; } /* Adjust max height for mobile */
            .two-column { flex-direction: column; gap: 20px; }
            .two-column > div { min-width: auto; }
             .activity-box input[type="text"], .activity-box textarea { width: calc(100% - 20px); } /* Smaller padding adjust */
             .navigation-buttons button { padding: 8px 15px; min-width: 100px; font-size: 1em; }
             .page-number { font-size: 0.9em; bottom: 15px; right: 15px;}

        }
         @media (max-width: 480px) {
             .slide { padding: 15px; }
             h1 { font-size: 1.6em; }
             h2 { font-size: 1.4em; }
             h3 { font-size: 1.2em; }
              .graphic-area svg { max-height: 150px; }
             .activity-box { padding: 15px; }
         }
    </style>
</head>
<body>

    <div class="slideshow-container">

        <!-- Slide 1: Title Slide - Document 2 -->
        <div class="slide active">
            <div class="content">
                <div class="graphic-area">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 80" fill="none" stroke="#0056b3" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="10" y="10" width="80" height="60" rx="5" fill="#e9f5ff"/> <!-- Document outline -->
                        <line x1="20" y1="25" x2="80" y2="25" stroke="#333"/> <!-- Title line -->
                        <line x1="20" y1="35" x2="70" y2="35" stroke="#333"/> <!-- Text line -->
                        <line x1="20" y1="45" x2="75" y2="45" stroke="#333"/> <!-- Text line -->
                        <line x1="20" y1="55" x2="60" y2="55" stroke="#333"/> <!-- Text line -->
                        <circle cx="80" cy="15" r="5" fill="#28a745"/> <!-- Green dot -->
                        <circle cx="80" cy="65" r="5" fill="#dc3545"/> <!-- Red dot -->
                         <text x="50" y="40" font-size="10" text-anchor="middle" alignment-baseline="middle">คาบที่ 2</text>
                    </svg>
                </div>
                 <h1>เอกสารประกอบการเรียน<br>วิทยาศาสตร์เพิ่มเติม 5 (ว23201)</h1>
                <p class="small-text">โครงงานวิทยาศาสตร์เพื่อปรับปรุงหรือพัฒนาสิ่งแวดล้อม</p>
                 <h2>คาบเรียนที่ 2: ปัญหาสิ่งแวดล้อมรอบตัวเรา!</h2>
                <p class="small-text">ชั้นมัธยมศึกษาปีที่ 3 | ภาคเรียนที่ 1 ปีการศึกษา 2568</p>
                 <p class="small-text">อาจารย์ผู้สอน: อาจารย์ชวดล ศรีบุญพิมพ์สวย</p>
            </div>
        </div>

        <!-- Slide 2: Review of Session 1 -->
        <div class="slide">
            <div class="content">
                 <div class="graphic-area">
                   <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 60" fill="none" stroke="#0056b3" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                       <rect x="5" y="5" width="90" height="50" rx="5"/>
                       <line x1="15" y1="15" x2="85" y2="15"/>
                       <line x1="15" y1="25" x2="75" y2="25"/>
                       <line x1="15" y1="35" x2="65" y2="35"/>
                       <line x1="15" y1="45" x2="85" y2="45"/>
                       <path d="M70 30 L75 35 L85 25" stroke="#28a745"/>
                   </svg>
                </div>
                <h2>ทบทวนความรู้จากคาบที่ 1</h2>
                <p>ในคาบที่ผ่านมา เราได้ทำความรู้จักกับรายวิชาโครงงานวิทยาศาสตร์เพื่อสิ่งแวดล้อม และได้ทบทวนความรู้พื้นฐานเกี่ยวกับ <strong>สิ่งแวดล้อม</strong></p>
                <p>สิ่งแวดล้อมคือทุกสิ่งรอบตัวเรา ทั้งสิ่งมีชีวิต (ชีวภาพ เช่น พืช สัตว์ คน) และสิ่งไม่มีชีวิต (กายภาพ เช่น อากาศ น้ำ ดิน อาคาร) ซึ่งมีความสำคัญและเชื่อมโยงกัน</p>
            </div>
        </div>

        <!-- Slide 3: Introduction to Environmental Problems -->
        <div class="slide">
             <div class="content">
                  <div class="graphic-area">
                   <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 80" fill="none" stroke="#dc3545" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                       <path d="M50 10 L30 40 H70 L50 10 Z" fill="#dc3545"/> <!-- Triangle -->
                       <path d="M30 40 Q20 60 50 70 Q80 60 70 40 Z" fill="#ffc107"/> <!-- Base -->
                       <circle cx="50" cy="70" r="8" fill="#28a745"/> <!-- Foundation -->
                       <circle cx="40" cy="50" r="5" fill="#dc3545"/> <!-- Problem dots -->
                       <circle cx="60" cy="50" r="5" fill="#dc3545"/>
                       <path d="M45 60 Q50 65 55 60" stroke="#007bff" stroke-width="3"/> <!-- Unhappy mouth -->
                       <path d="M30 40 L10 30 L5 40 L25 50 Z" fill="#cccccc" stroke="none"/> <!-- Side element -->
                       <path d="M70 40 L90 30 L95 40 L75 50 Z" fill="#cccccc" stroke="none"/> <!-- Side element -->
                   </svg>
                </div>
                <h2>เข้าสู่หัวข้อ: ปัญหาสิ่งแวดล้อม</h2>
                <p>ในคาบเรียนนี้ เราจะมาทำความเข้าใจว่า "ปัญหาสิ่งแวดล้อม" คืออะไร มีกี่ประเภท อะไรคือสาเหตุและผลกระทบของปัญหาเหล่านี้ และเราพบปัญหาในระดับใดบ้าง</p>
                <p><strong>ปัญหาสิ่งแวดล้อม</strong> คือสภาวะของสิ่งแวดล้อมที่เสื่อมโทรมลงจากการกระทำของมนุษย์หรือปัจจัยธรรมชาติ ซึ่งส่งผลเสียต่อสิ่งมีชีวิตและระบบนิเวศ</p>
            </div>
        </div>

        <!-- Slide 4: Types of Environmental Problems - Overview -->
        <div class="slide">
             <div class="content">
                  <div class="graphic-area">
                   <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 80" fill="none" stroke="#0056b3" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                       <circle cx="50" cy="40" r="35" stroke="#28a745" stroke-dasharray="5 5"/>
                       <circle cx="30" cy="30" r="10" fill="#dc3545"/> <!-- Pollution -->
                       <rect x="65" y="20" width="15" height="20" rx="3" fill="#ffc107"/> <!-- Waste -->
                       <path d="M35 55 L45 55 L40 65 Z" fill="#007bff"/> <!-- Climate Change -->
                       <path d="M60 55 C60 55 65 50 70 55 S80 55 80 60 S75 65 70 60 S65 65 60 60 S60 55 60 55" fill="#17a2b8"/> <!-- Biodiversity -->
                        <text x="30" y="30" font-size="10" fill="white" text-anchor="middle" alignment-baseline="middle">มลพิษ</text>
                         <text x="72.5" y="30" font-size="10" fill="white" text-anchor="middle" alignment-baseline="middle">ขยะ</text>
                          <text x="40" y="55" font-size="10" fill="white" text-anchor="middle" alignment-baseline="middle">ภูมิอากาศ</text>
                           <text x="70" y="57.5" font-size="10" fill="white" text-anchor="middle" alignment-baseline="middle">ชีวภาพ</text>
                   </svg>
                </div>
                <h2>ประเภทของปัญหาสิ่งแวดล้อมที่พบบ่อย</h2>
                <p>ปัญหาสิ่งแวดล้อมหลักๆ ที่เราควรรู้จัก ได้แก่:</p>
                <ul>
                    <li><strong>มลพิษ (Pollution):</strong> การปนเปื้อนสิ่งที่เป็นอันตรายในสิ่งแวดล้อม เช่น มลพิษทางอากาศ น้ำ ดิน เสียง แสง</li>
                    <li><strong>ปัญหาขยะ (Waste Management):</strong> การจัดการของเสียที่ไม่เหมาะสม ทำให้เกิดการสะสมและผลกระทบอื่นๆ</li>
                    <li><strong>การเปลี่ยนแปลงสภาพภูมิอากาศ (Climate Change):</strong> การเปลี่ยนแปลงสภาพอากาศโลกในระยะยาว ส่วนใหญ่เกิดจากก๊าซเรือนกระจก</li>
                    <li><strong>การสูญเสียความหลากหลายทางชีวภาพ (Biodiversity Loss):</strong> การลดลงหรือการสูญพันธุ์ของสิ่งมีชีวิต ซึ่งส่งผลต่อความสมดุลของระบบนิเวศ</li>
                </ul>
            </div>
        </div>

        <!-- Slide 5: Problem Type 1: Pollution -->
         <div class="slide">
             <div class="content">
                  <div class="graphic-area">
                   <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 80" fill="none" stroke="#0056b3" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                       <path d="M10 70 C20 50 30 50 40 70 H10 Z" fill="#dc3545"/> <!-- Soil Pollution -->
                       <path d="M60 70 C70 50 80 50 90 70 H60 Z" fill="#dc3545"/> <!-- Soil Pollution -->
                       <path d="M20 40 C30 20 70 20 80 40 H20 Z" fill="#ffc107"/> <!-- Air Pollution Base -->
                       <circle cx="40" cy="30" r="5" fill="#333"/>
                       <circle cx="55" cy="25" r="4" fill="#333"/>
                       <circle cx="70" cy="30" r="6" fill="#333"/> <!-- Air Pollution Smoke -->
                       <rect x="30" y="50" width="40" height="20" fill="#cccccc"/> <!-- Water body -->
                       <path d="M35 60 Q45 55 50 60 Q55 65 65 60" stroke="#dc3545" stroke-width="3"/> <!-- Polluted Water -->
                        <text x="50" y="15" font-size="8" text-anchor="middle" fill="#0056b3">AIR</text>
                         <text x="50" y="75" font-size="8" text-anchor="middle" fill="#0056b3">SOIL</text>
                          <text x="50" y="55" font-size="8" text-anchor="middle" fill="#0056b3">WATER</text>
                   </svg>
                </div>
                <h2>ปัญหา: มลพิษ (Pollution)</h2>
                <p><strong>มลพิษ</strong> คือ การที่สิ่งแวดล้อม (อากาศ น้ำ ดิน) ถูกปนเปื้อนด้วยสารหรือพลังงานที่ทำให้คุณภาพสิ่งแวดล้อมเสื่อมลง จนอาจเป็นอันตรายต่อสิ่งมีชีวิต</p>
                 <h3>ตัวอย่างและสาเหตุ:</h3>
                 <ul>
                     <li><strong>มลพิษทางอากาศ:</strong> ควันจากรถยนต์ โรงงาน ไฟป่า (สาเหตุ: การเผาไหม้เชื้อเพลิง)</li>
                     <li><strong>มลพิษทางน้ำ:</strong> น้ำเสียจากบ้านเรือน โรงงาน เกษตรกรรม (สาเหตุ: การทิ้งของเสียลงแหล่งน้ำโดยไม่บำบัด)</li>
                     <li><strong>มลพิษทางดิน:</strong> สารเคมีจากโรงงานอุตสาหกรรม ขยะ สารกำจัดศัตรูพืช (สาเหตุ: การใช้สารเคมี การทิ้งขยะอันตราย)</li>
                     <li><strong>มลพิษทางเสียง แสง ความร้อน:</strong> เสียงดังรบกวน แสงไฟจ้า ความร้อนสูง (สาเหตุ: กิจกรรมอุตสาหกรรม การคมนาคม แหล่งกำเนิดความร้อน)</li>
                 </ul>
                 <h3>ผลกระทบ:</h3>
                 <ul>
                     <li>ส่งผลเสียต่อ <strong>สุขภาพ</strong> มนุษย์ (โรคระบบทางเดินหายใจ, โรคผิวหนัง, ปัญหาสายตา/การได้ยิน)</li>
                     <li>ทำลาย <strong>ระบบนิเวศ</strong> ทำให้สิ่งมีชีวิตตายหรือเจ็บป่วย</li>
                     <li>สร้างความเสียหายต่อ <strong>อาคาร สิ่งก่อสร้าง</strong></li>
                 </ul>
            </div>
         </div>

         <!-- Slide 6: Problem Type 2: Waste -->
         <div class="slide">
             <div class="content">
                  <div class="graphic-area">
                   <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 80" fill="none" stroke="#0056b3" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                       <rect x="20" y="20" width="60" height="40" fill="#cccccc"/>
                       <line x1="20" y1="20" x2="30" y2="10"/>
                       <line x1="80" y1="20" x2="70" y2="10"/>
                       <line x1="30" y1="10" x2="70" y2="10"/> <!-- Trash can shape -->
                       <path d="M25 30 L75 30" stroke="#ffc107" stroke-width="4"/>
                       <path d="M30 40 L70 40" stroke="#ffc107" stroke-width="4"/>
                       <path d="M35 50 L65 50" stroke="#ffc107" stroke-width="4"/>
                        <circle cx="40" cy="35" r="5" fill="#dc3545"/>
                         <circle cx="60" cy="45" r="6" fill="#dc3545"/>
                         <circle cx="50" cy="38" r="4" fill="#dc3545"/> <!-- Trash items -->
                          <path d="M10 70 Q30 60 50 70 Q70 80 90 70 L80 60 H20 L10 70 Z" fill="#28a745"/> <!-- Ground -->
                   </svg>
                </div>
                <h2>ปัญหา: ขยะ (Waste Management)</h2>
                <p><strong>ปัญหาขยะ</strong> เกิดขึ้นเมื่อของเสียที่เกิดจากกิจกรรมต่างๆ ของมนุษย์ถูกทิ้งหรือจัดการอย่างไม่ถูกต้อง ทำให้เกิดการสะสมและปัญหามลพิษอื่นๆ ตามมา</p>
                 <h3>ตัวอย่างและสาเหตุ:</h3>
                 <ul>
                     <li><strong>ขยะมูลฝอยทั่วไป:</strong> เศษอาหาร พลาสติก กระดาษ โลหะ (สาเหตุ: การบริโภคในชีวิตประจำวัน)</li>
                     <li><strong>ขยะอุตสาหกรรม:</strong> ของเสียจากกระบวนการผลิต</li>
                     <li><strong>ขยะอันตราย:</strong> แบตเตอรี่ สารเคมีหมดอายุ ขยะอิเล็กทรอนิกส์</li>
                 </ul>
                 <h3>ปัญหาจากการจัดการขยะที่ไม่ถูกต้อง:</h3>
                 <ul>
                     <li>การฝังกลบที่ไม่ถูกสุขลักษณะ: ทำให้ดินและน้ำใต้ดินปนเปื้อน</li>
                     <li>การเผาขยะ: ทำให้เกิดมลพิษทางอากาศ (ฝุ่นละออง PM2.5, สารพิษ)</li>
                     <li>ขยะตกค้างในสิ่งแวดล้อม: อุดตันทางน้ำ, สัตว์กินเข้าไป, ทำให้พื้นที่สกปรกไม่สวยงาม</li>
                 </ul>
            </div>
         </div>

          <!-- Slide 7: Problem Type 3: Climate Change -->
         <div class="slide">
             <div class="content">
                  <div class="graphic-area">
                   <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 80" fill="none" stroke="#0056b3" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                       <circle cx="50" cy="40" r="35" fill="#007bff" opacity="0.5"/> <!-- Earth outline -->
                       <path d="M20 40 C30 30 70 30 80 40" stroke="#dc3545" stroke-width="4"/> <!-- Stress line -->
                       <path d="M40 50 C45 45 55 45 60 50" stroke="#ffc107" stroke-width="4"/> <!-- Stress line -->
                       <path d="M25 60 L35 50 M35 60 L25 50" stroke="#dc3545"/> <!-- Melted ice -->
                       <path d="M75 60 L65 50 M65 60 L75 50" stroke="#dc3545"/> <!-- Melted ice -->
                       <line x1="50" y1="15" x2="50" y2="25" stroke="#dc3545" stroke-width="4"/> <!-- Heat indicator -->
                        <path d="M45 20 L50 15 L55 20" stroke="#dc3545" stroke-width="4"/> <!-- Heat indicator -->
                   </svg>
                </div>
                <h2>ปัญหา: การเปลี่ยนแปลงสภาพภูมิอากาศ (Climate Change)</h2>
                <p>หมายถึง การเปลี่ยนแปลงของอุณหภูมิและรูปแบบสภาพอากาศในระยะยาว ซึ่งส่วนใหญ่เกิดจาก <strong>กิจกรรมของมนุษย์ที่ปล่อยก๊าซเรือนกระจก</strong> (เช่น คาร์บอนไดออกไซด์, มีเทน) สู่ชั้นบรรยากาศมากเกินไป</p>
                 <h3>สาเหตุหลัก:</h3>
                 <ul>
                     <li>การเผาไหม้เชื้อเพลิงฟอสซิล (น้ำมัน ก๊าซ ถ่านหิน) เพื่อผลิตพลังงาน การขนส่ง อุตสาหกรรม</li>
                     <li>การทำลายป่า (ป่าช่วยดูดซับคาร์บอนไดออกไซด์)</li>
                     <li>กิจกรรมทางการเกษตรและปศุสัตว์บางประเภท</li>
                 </ul>
                 <h3>ผลกระทบสำคัญ:</h3>
                 <ul>
                     <li>อุณหภูมิเฉลี่ยโลกสูงขึ้น (ภาวะโลกร้อน)</li>
                     <li>การละลายของน้ำแข็งขั้วโลกและธารน้ำแข็ง -> ระดับน้ำทะเลสูงขึ้น</li>
                     <li>การเกิดเหตุการณ์สภาพอากาศสุดขั้วบ่อยขึ้นและรุนแรงขึ้น (น้ำท่วม, ภัยแล้ง, พายุ, คลื่นความร้อน)</li>
                     <li>การเปลี่ยนแปลงของฤดูกาลและระบบนิเวศ</li>
                 </ul>
            </div>
         </div>

          <!-- Slide 8: Problem Type 4: Biodiversity Loss -->
         <div class="slide">
             <div class="content">
                  <div class="graphic-area">
                   <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 80" fill="none" stroke="#0056b3" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                       <path d="M20 70 L30 60 V50 L10 40 L20 70 Z" fill="#28a745"/> <!-- Healthy Tree section -->
                        <circle cx="20" cy="30" r="8" fill="#28a745"/> <!-- Leaf crown -->

                        <path d="M50 70 L60 60 V50 L40 40 L50 70 Z" fill="#cccccc"/> <!-- Dying Tree section -->
                        <path d="M45 30 C50 20 60 20 55 30 L50 35 Z" fill="#dc3545"/> <!-- Wilting leaves -->

                         <path d="M80 70 L90 60 V50 L70 40 L80 70 Z" fill="#ffc107"/> <!-- Stump -->
                         <rect x="75" y="55" width="10" height="15" fill="#8b4513"/>

                         <path d="M15 35 Q25 25 30 35" stroke="#dc3545" stroke-width="3"/> <!-- Arrow pointing from healthy to problems -->
                         <path d="M45 45 Q55 35 60 45" stroke="#dc3545" stroke-width="3"/>
                         <path d="M75 45 Q85 35 90 45" stroke="#dc3545" stroke-width="3"/>

                         <path d="M10 30 L20 20 L30 30 L20 40 Z" fill="#17a2b8"/> <!-- Healthy Ecosystem Element -->
                         <path d="M70 30 L80 20 L90 30 L80 40 Z" fill="#cccccc"/> <!-- Fading Ecosystem Element -->
                   </svg>
                </div>
                <h2>ปัญหา: การสูญเสียความหลากหลายทางชีวภาพ (Biodiversity Loss)</h2>
                <p>คือ การลดจำนวนลงหรือการสูญพันธุ์ของสิ่งมีชีวิตชนิดต่างๆ รวมถึงการลดความหลากหลายทางพันธุกรรมและความหลากหลายของระบบนิเวศ</p>
                 <p>ความหลากหลายทางชีวภาพมีความสำคัญอย่างยิ่งต่อความสมดุลของธรรมชาติและประโยชน์ที่มนุษย์ได้รับจากระบบนิเวศ</p>
                 <h3>สาเหตุหลัก:</h3>
                 <ul>
                     <li><strong>การทำลายแหล่งที่อยู่อาศัย:</strong> การตัดไม้ทำลายป่า การเปลี่ยนพื้นที่ป่าเป็นพื้นที่เกษตร/อุตสาหกรรม/ชุมชน</li>
                     <li><strong>มลพิษ:</strong> สารเคมีและมลพิษต่างๆ ทำลายสิ่งมีชีวิตและแหล่งที่อยู่</li>
                     <li><strong>การเปลี่ยนแปลงสภาพภูมิอากาศ:</strong> สภาพอากาศที่เปลี่ยนไปทำให้สิ่งมีชีวิตปรับตัวไม่ได้</li>
                     <li><strong>การรุกรานของชนิดพันธุ์ต่างถิ่น:</strong> สิ่งมีชีวิตต่างถิ่นเข้ามาแย่งชิงทรัพยากรหรือล่าสิ่งมีชีวิตพื้นเมือง</li>
                     <li>การล่า การจับ การเก็บเกี่ยวสิ่งมีชีวิตมากเกินไป</li>
                 </ul>
                 <h3>ผลกระทบ:</h3>
                 <ul>
                     <li>ระบบนิเวศขาดความสมดุล อ่อนแอลง</li>
                     <li>สูญเสียแหล่งอาหาร ยา และทรัพยากรอื่นๆ จากธรรมชาติ</li>
                     <li>ส่งผลต่อความมั่นคงทางอาหารและน้ำ</li>
                 </ul>
            </div>
         </div>

        <!-- Slide 9: Interconnectedness of Problems -->
         <div class="slide">
             <div class="content">
                  <div class="graphic-area">
                   <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 80" fill="none" stroke="#0056b3" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                       <circle cx="30" cy="30" r="15" fill="#dc3545"/> <!-- Problem 1 -->
                       <circle cx="70" cy="30" r="15" fill="#ffc107"/> <!-- Problem 2 -->
                       <circle cx="50" cy="65" r="15" fill="#007bff"/> <!-- Problem 3 -->

                       <path d="M40 35 Q50 50 45 60" stroke="#333" stroke-dasharray="5 5"/> <!-- Link 1-3 -->
                        <path d="M60 35 Q50 50 55 60" stroke="#333" stroke-dasharray="5 5"/> <!-- Link 2-3 -->
                         <path d="M35 25 Q50 20 65 25" stroke="#333" stroke-dasharray="5 5"/> <!-- Link 1-2 -->

                         <text x="30" y="30" font-size="10" fill="white" text-anchor="middle" alignment-baseline="middle">มลพิษ</text>
                         <text x="70" y="30" font-size="10" fill="white" text-anchor="middle" alignment-baseline="middle">ขยะ</text>
                         <text x="50" y="65" font-size="10" fill="white" text-anchor="middle" alignment-baseline="middle">ภูมิอากาศ</text>
                   </svg>
                </div>
                <h2>ปัญหาสิ่งแวดล้อมเชื่อมโยงกัน!</h2>
                 <p>ปัญหาสิ่งแวดล้อมต่างๆ ที่กล่าวมา มักไม่ได้เกิดขึ้นอย่างโดดเดี่ยว แต่มีความ <strong>เชื่อมโยงและส่งผลกระทบถึงกัน</strong></p>
                 <ul>
                     <li>เช่น <strong>การเผาไหม้</strong> (สาเหตุของมลพิษทางอากาศ) ก็เป็นสาเหตุหลักของ <strong>การเปลี่ยนแปลงสภาพภูมิอากาศ</strong></li>
                     <li><strong>มลพิษทางน้ำ</strong> ทำให้ <strong>สิ่งมีชีวิตในน้ำตาย</strong> ซึ่งนำไปสู่ <strong>การสูญเสียความหลากหลายทางชีวภาพ</strong></li>
                     <li><strong>การเปลี่ยนแปลงสภาพภูมิอากาศ</strong> อาจทำให้ <strong>แหล่งที่อยู่อาศัย</strong> ของสิ่งมีชีวิตบางชนิดเปลี่ยนแปลงไป หรือเกิดภัยพิบัติ เช่น <strong>น้ำท่วม</strong> ซึ่งก็เกี่ยวข้องกับ <strong>ปัญหาขยะ</strong> ที่อุดตันทางน้ำ</li>
                 </ul>
                 <p>การเข้าใจความเชื่อมโยงนี้สำคัญมาก ในการคิดหาทางแก้ไขปัญหาแบบองค์รวม</p>
            </div>
         </div>

         <!-- Slide 10: Levels of Environmental Problems -->
         <div class="slide">
             <div class="content">
                  <div class="graphic-area">
                   <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 80" fill="none" stroke="#0056b3" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                       <rect x="10" y="50" width="25" height="20" fill="#28a745"/> <!-- Local House -->
                       <path d="M15 50 V40 L22.5 35 L30 40 V50 Z" fill="#28a745"/>
                       <circle cx="22.5" cy="45" r="3" fill="#0056b3"/> <!-- Window -->
                        <text x="22.5" y="75" font-size="10" text-anchor="middle">ชุมชน</text>

                       <rect x="40" y="40" width="30" height="30" fill="#007bff"/> <!-- National Map -->
                       <path d="M45 45 L65 45 L60 55 L50 60 Z" stroke="#ffffff" stroke-width="2"/>
                        <text x="55" y="55" font-size="12" fill="white" text-anchor="middle">TH</text>
                         <text x="55" y="75" font-size="10" text-anchor="middle">ประเทศ</text>


                       <circle cx="80" cy="35" r="15" fill="#17a2b8"/> <!-- Globe -->
                       <path d="M80 20 A15 15 0 0 0 80 50" stroke="#ffffff" stroke-width="2"/>
                       <path d="M65 35 H95" stroke="#ffffff" stroke-width="2"/>
                        <text x="80" y="55" font-size="10" text-anchor="middle">โลก</text>

                       <path d="M25 50 L40 40" stroke="#333" stroke-dasharray="5 5"/> <!-- Links -->
                       <path d="M70 45 L80 35" stroke="#333" stroke-dasharray="5 5"/>
                   </svg>
                </div>
                <h2>ปัญหาสิ่งแวดล้อมในระดับต่างๆ</h2>
                 <p>ปัญหาสิ่งแวดล้อมเกิดขึ้นได้ในหลายระดับ ตั้งแต่ใกล้ตัวเราที่สุด ไปจนถึงระดับโลก:</p>
                 <div class="two-column">
                     <div>
                         <h3>ระดับชุมชน/ท้องถิ่น</h3>
                         <p>ปัญหาที่พบเห็นได้ในบริเวณบ้าน โรงเรียน หมู่บ้าน หรืออำเภอของนักเรียน เช่น:</p>
                         <ul>
                             <li>ขยะเกลื่อนกลาดในชุมชน</li>
                             <li>น้ำเสียในคลองใกล้บ้าน</li>
                             <li>มลพิษทางอากาศ (เช่น PM2.5 ในบางช่วง)</li>
                             <li>การบุกรุกพื้นที่สีเขียวในท้องถิ่น</li>
                         </ul>
                     </div>
                      <div>
                         <h3>ระดับประเทศและโลก</h3>
                         <p>ปัญหาที่ส่งผลกระทบในวงกว้าง หรือข้ามพรมแดน เช่น:</p>
                         <ul>
                             <li>ปัญหามลพิษข้ามแดน (หมอกควัน)</li>
                             <li>การจัดการขยะอิเล็กทรอนิกส์</li>
                             <li>การเปลี่ยนแปลงสภาพภูมิอากาศโลก</li>
                             <li>การลดลงของสัตว์ป่าใกล้สูญพันธุ์ทั่วโลก</li>
                             <li>ปัญหามลพิษในมหาสมุทร</li>
                         </ul>
                      </div>
                 </div>
                  <p style="font-style: italic; text-align: center; margin-top: 10px;">ปัญหาระดับเล็กๆ มักเป็นส่วนหนึ่งของปัญหาระดับที่ใหญ่ขึ้นได้</p>
            </div>
         </div>


        <!-- Slide 11: Activity 1: Media Analysis -->
        <div class="slide">
             <div class="content">
                 <div class="graphic-area">
                   <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 80" fill="none" stroke="#0056b3" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                       <rect x="10" y="15" width="80" height="50" rx="5" fill="#e9f5ff"/> <!-- Screen -->
                       <line x1="20" y1="25" x2="50" y2="25" stroke="#333"/> <!-- Text line 1 -->
                       <line x1="20" y1="35" x2="60" y2="35" stroke="#333"/> <!-- Text line 2 -->
                       <rect x="20" y="45" width="40" height="15" fill="#dc3545"/> <!-- Problem representation -->
                       <circle cx="75" cy="52.5" r="8" fill="#28a745"/> <!-- Observer eye -->
                       <circle cx="75" cy="52.5" r="2" fill="#ffffff"/>
                       <path d="M75 65 V70 H80" stroke="#333"/> <!-- Stand -->
                   </svg>
                </div>
                <h2>กิจกรรมที่ 1: วิเคราะห์ปัญหาสิ่งแวดล้อมจากสื่อ</h2>
                <p>นักเรียนได้ชมภาพนิ่ง วีดิทัศน์ หรือข่าวสั้นๆ เกี่ยวกับปัญหาสิ่งแวดล้อมในชั้นเรียนแล้ว</p>
                <p>จากสื่อที่ได้ชม หรือจากข่าวสาร/สื่ออื่นๆ เกี่ยวกับสิ่งแวดล้อมที่นักเรียนเคยพบเห็น ให้เลือกปัญหาที่นักเรียนสนใจ <strong>1 ปัญหา</strong> แล้วอธิบายสั้นๆ ในช่องด้านล่าง</p>

                 <div class="activity-box">
                     <h4>บันทึกปัญหาที่พบจากสื่อ</h4>
                     <form id="activity1-form">
                         <label for="student-id-1">เลขประจำตัวนักเรียน:</label>
                         <input type="text" id="student-id-1" name="Student ID" placeholder="กรอกเลขประจำตัวนักเรียน" required>

                         <label for="media-problem">อธิบายปัญหาสิ่งแวดล้อมที่นักเรียนสนใจ/พบเห็นจากสื่อ:</label>
                         <textarea id="media-problem" name="Media Problem Description" placeholder="ระบุประเภทปัญหา, สาเหตุ (ถ้าทราบ), และผลกระทบที่นักเรียนเห็นหรือได้ยิน"></textarea>

                         <button type="submit">บันทึกข้อมูลกิจกรรมที่ 1</button>
                         <div class="submission-status" id="submission-status-1"></div>
                     </form>
                 </div>
            </div>
        </div>

         <!-- Slide 12: Activity 2: Brainstorming Local Problems -->
        <div class="slide">
             <div class="content">
                  <div class="graphic-area">
                   <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 80" fill="none" stroke="#0056b3" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                       <circle cx="50" cy="40" r="25" fill="#ffc107"/> <!-- Lightbulb -->
                       <path d="M40 40 C35 30 65 30 60 40 Z" stroke="#0056b3"/> <!-- Filament -->
                       <line x1="45" y1="50" x2="55" y2="50" stroke="#0056b3" stroke-width="4"/>
                        <path d="M50 50 V60" stroke="#0056b3" stroke-width="4"/>
                       <path d="M40 60 C35 65 65 65 60 60 Z" stroke="#0056b3" fill="#0056b3"/>

                       <circle cx="30" cy="20" r="8" fill="#e9f5ff"/> <!-- Idea Bubble 1 -->
                       <circle cx="70" cy="20" r="8" fill="#fff0f3"/> <!-- Idea Bubble 2 -->
                        <path d="M35 25 L45 35" stroke="#333" stroke-dasharray="3 3"/>
                         <path d="M65 25 L55 35" stroke="#333" stroke-dasharray="3 3"/>
                   </svg>
                </div>
                <h2>กิจกรรมที่ 2: ระดมสมองปัญหาสิ่งแวดล้อมในท้องถิ่น</h2>
                <p>ในชั้นเรียน นักเรียนได้ทำงานกลุ่มเพื่อระดมสมองปัญหาสิ่งแวดล้อมที่พบในชุมชน/ท้องถิ่น หรือบริเวณโรงเรียน</p>
                <p>ให้นักเรียนนึกถึงปัญหาเหล่านั้น หรือปัญหาอื่นๆ ในท้องถิ่นที่นักเรียนสนใจเป็นพิเศษ <strong>เลือกมา 1 ปัญหา</strong> ที่นักเรียนคิดว่าน่าสนใจและอาจนำไปพัฒนาเป็นหัวข้อโครงงานได้ในอนาคต</p>
                <p>กรอกรายละเอียดเกี่ยวกับปัญหานั้น และเหตุผลที่นักเรียนสนใจลงในช่องด้านล่าง</p>

                 <div class="activity-box">
                     <h4>ปัญหาท้องถิ่นที่สนใจ (เพื่อทำโครงงาน)</h4>
                     <form id="activity2-form">
                         <label for="student-id-2">เลขประจำตัวนักเรียน:</label>
                         <input type="text" id="student-id-2" name="Student ID" placeholder="กรอกเลขประจำตัวนักเรียน" required>

                         <label for="brainstorm-problem">ระบุปัญหาท้องถิ่นที่นักเรียนสนใจ:</label>
                         <textarea id="brainstorm-problem" name="Brainstormed Problem" placeholder="อธิบายปัญหาที่พบในท้องถิ่นของนักเรียน เช่น ปัญหาขยะริมคลองในหมู่บ้าน, ปัญหาใบไม้ร่วงเยอะในโรงเรียน"></textarea>

                          <label for="reason-interest">เหตุผลที่นักเรียนสนใจปัญหานี้:</label>
                         <textarea id="reason-interest" name="Reason for Interest" placeholder="เพราะอะไรนักเรียนถึงสนใจปัญหานี้เป็นพิเศษ?"></textarea>

                         <button type="submit">บันทึกข้อมูลกิจกรรมที่ 2</button>
                         <div class="submission-status" id="submission-status-2"></div>
                     </form>
                 </div>
            </div>
        </div>


        <!-- Slide 13: Looking Ahead -->
        <div class="slide">
             <div class="content">
                 <div class="graphic-area">
                   <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 80" fill="none" stroke="#0056b3" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                       <path d="M20 70 L30 60 V30 L10 20 L20 70 Z" fill="#28a745"/> <!-- Looking up -->
                       <circle cx="25" cy="15" r="8" fill="#ffc107"/> <!-- Lightbulb/Idea -->
                       <path d="M25 23 V30" stroke="#ffc107" stroke-width="3"/>

                       <path d="M80 70 L70 60 V30 L90 20 L80 70 Z" fill="#007bff"/> <!-- Planning/Organizing -->
                       <rect x="65" y="35" width="10" height="10" fill="#ffffff"/> <!-- Boxes -->
                       <rect x="75" y="40" width="10" height="10" fill="#ffffff"/>
                       <rect x="60" y="45" width="10" height="10" fill="#ffffff"/>

                        <line x1="30" y1="50" x2="70" y2="50" stroke="#333" stroke-dasharray="5 5"/> <!-- Path -->
                         <circle cx="50" cy="50" r="5" fill="#dc3545"/> <!-- Problem dot -->
                   </svg>
                </div>
                <h2>มองไปข้างหน้า: คาบเรียนต่อไป (คาบที่ 3)</h2>
                <p>ในคาบเรียนหน้า เราจะเริ่มเข้าสู่ขั้นตอนของการทำโครงงานอย่างจริงจังครับ</p>
                <p>เราจะเรียนรู้ <strong>เทคนิคการสำรวจและระบุปัญหา</strong> ในพื้นที่จริง (เช่น บริเวณโรงเรียน) และจะมีการ <strong>คัดเลือกปัญหา</strong> ที่แต่ละกลุ่มสนใจอย่างชัดเจน เพื่อนำไปพัฒนาเป็นโครงงานต่อไป</p>
                <p>คาบหน้าจะมีการ <strong>แบ่งกลุ่มทำโครงงานอย่างเป็นทางการ</strong> (กลุ่มละ 4-5 คน) ดังนั้น นักเรียนที่ยังไม่มีกลุ่มหรือไม่แน่ใจ เตรียมตัวพูดคุยกับเพื่อนๆ และตัดสินใจนะครับ!</p>
            </div>
        </div>

    </div>

    <!-- Navigation Buttons -->
    <div class="navigation-buttons">
        <button onclick="prevSlide()" id="prevBtn">ก่อนหน้า</button>
        <button onclick="nextSlide()" id="nextBtn">ถัดไป</button>
    </div>

    <!-- Page Number -->
    <div class="page-number">
        หน้า <span id="currentSlide">1</span> จาก <span id="totalSlides"></span>
    </div>

    <script>
        // *** สำคัญมาก: เปลี่ยน URL ด้านล่างนี้เป็น Web App URL ของ Google Apps Script ที่คุณสร้างขึ้น ***
        const GOOGLE_SHEET_WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbwvqWC_4jf3fd7_XQFv2tnbUjt-lyK4_V61XECseI7lxiC0z2jSbkh64vZJlfz0dxmBFA/exec';

        let slideIndex = 0;
        const slides = document.querySelectorAll('.slide');
        const totalSlidesSpan = document.getElementById('totalSlides');
        const currentSlideSpan = document.getElementById('currentSlide');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');

        totalSlidesSpan.textContent = slides.length;

        function showSlide(index) {
            if (index < 0) {
                slideIndex = 0;
            } else if (index >= slides.length) {
                slideIndex = slides.length - 1;
            } else {
                slideIndex = index;
            }

            slides.forEach((slide, i) => {
                if (i === slideIndex) {
                    slide.classList.add('active');
                    slide.style.opacity = 1;
                    // Reset scroll position when slide becomes active
                    slide.scrollTop = 0;
                } else {
                    slide.classList.remove('active');
                    slide.style.opacity = 0;
                }
            });

            currentSlideSpan.textContent = slideIndex + 1;

            // Update button states
            prevBtn.disabled = slideIndex === 0;
            nextBtn.disabled = slideIndex === slides.length - 1;
        }

        function nextSlide() {
            showSlide(slideIndex + 1);
        }

        function prevSlide() {
            showSlide(slideIndex - 1);
        }

        // Initialize the first slide
        showSlide(slideIndex);


        // Optional: Add keyboard navigation
        document.addEventListener('keydown', function(event) {
            // Check if the focus is NOT on an input or textarea before navigating with arrows
            if (!event.target.matches('input, textarea')) {
                if (event.key === 'ArrowRight') {
                    nextSlide();
                } else if (event.key === 'ArrowLeft') {
                    prevSlide();
                }
            }
        });


         // --- Google Sheet Submission Handling ---
         const form1 = document.getElementById('activity1-form');
         const submitButton1 = form1.querySelector('button');
         const submissionStatusDiv1 = document.getElementById('submission-status-1');

          const form2 = document.getElementById('activity2-form');
         const submitButton2 = form2.querySelector('button');
         const submissionStatusDiv2 = document.getElementById('submission-status-2');


         function handleFormSubmission(event, statusDiv, submitBtn) {
             event.preventDefault(); // Stop the form from submitting the traditional way

             statusDiv.textContent = 'กำลังบันทึกข้อมูล...';
             statusDiv.className = ''; // Clear previous status classes
             submitBtn.disabled = true; // Disable the button during submission

             const formData = new FormData(event.target); // Get data from the specific form

             // Basic validation for Student ID
             const studentIdInput = event.target.querySelector('input[name="Student ID"]');
              if (!studentIdInput || !studentIdInput.value) {
                  statusDiv.textContent = 'กรุณากรอกเลขประจำตัวนักเรียนครับ';
                  statusDiv.className = 'status-error';
                  submitBtn.disabled = false;
                  return; // Stop the submission
              }


             fetch(GOOGLE_SHEET_WEB_APP_URL, {
                 method: 'POST',
                 body: formData
             })
             .then(response => response.text()) // Assume the script returns text "Success" or "Error: ..."
             .then(data => {
                 console.log('Response from script:', data); // Log the response for debugging
                  if (data.trim() === 'Success') {
                     statusDiv.textContent = 'บันทึกข้อมูลสำเร็จแล้วครับ!';
                     statusDiv.className = 'status-success';
                     // Optional: Clear the form after successful submission
                     // event.target.reset();
                 } else {
                      // Display the error message returned by the script if not "Success"
                      statusDiv.textContent = 'เกิดข้อผิดพลาดในการบันทึกข้อมูล: ' + (data.trim() || 'ไม่ทราบข้อผิดพลาด');
                      statusDiv.className = 'status-error';
                 }
             })
             .catch((error) => {
                 console.error('Fetch error:', error);
                 statusDiv.textContent = 'เกิดข้อผิดพลาดในการเชื่อมต่อหรือบันทึกข้อมูลครับ กรุณาลองใหม่อีกครั้ง';
                  statusDiv.className = 'status-error';
             })
             .finally(() => {
                 submitBtn.disabled = false; // Re-enable the button
             });
         }

         // Attach the event listener to each form
         form1.addEventListener('submit', function(event){
             handleFormSubmission(event, submissionStatusDiv1, submitButton1);
         });

          form2.addEventListener('submit', function(event){
             handleFormSubmission(event, submissionStatusDiv2, submitButton2);
         });


    </script>

</body>
</html>
